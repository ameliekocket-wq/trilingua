<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Trilingua</title>

<style>
body { margin:0; font-family:-apple-system,BlinkMacSystemFont,sans-serif; background:#f2f7fb; text-align:center; }
header { background:#cfe9f7; padding:25px; border-bottom-left-radius:25px; border-bottom-right-radius:25px; }
.stats { font-size:14px; margin-top:10px; }
.container { padding:20px; }
.card { background:white; margin:15px auto; padding:20px; border-radius:20px; width:85%; max-width:420px; box-shadow:0 4px 15px rgba(0,0,0,0.05);}
button { margin:8px; padding:10px 16px; border:none; border-radius:15px; background:#cfe9f7; cursor:pointer; }
.progressbar { width:80%; max-width:400px; height:10px; background:#ddd; margin:10px auto; border-radius:10px; overflow:hidden;}
.progress { height:100%; width:0%; background:#ffb3c6; transition:0.3s;}
.repeat { color:#ff6b81; font-size:13px; margin-bottom:5px;}
</style>
</head>

<body>

<header>
<h1>Trilingua</h1>
<div class="stats">
â­ XP: <span id="xp">0</span> |
ğŸ† Level: <span id="level">1</span>
</div>
<div class="progressbar"><div class="progress" id="progress"></div></div>
</header>

<div class="container" id="menu">
<div class="card" onclick="startLesson('nor')">ğŸ‡³ğŸ‡´ Norwegisch</div>
<div class="card" onclick="startLesson('spa')">ğŸ‡ªğŸ‡¸ Spanisch</div>
<div class="card" onclick="startLesson('eng')">ğŸ‡¬ğŸ‡§ Englisch</div>
</div>

<div class="container" id="lesson" style="display:none;"></div>

<script>
let xp = parseInt(localStorage.getItem("xp")) || 0;
let level = parseInt(localStorage.getItem("level")) || 1;

const questions = {
nor:[
{q:"Was bedeutet 'Hei'?",correct:"Hallo",options:["Hallo","Danke","Bitte","TschÃ¼ss"]},
{q:"Ãœbersetze: 'Jeg lÃ¦rer norsk.'",correct:"Ich lerne Norwegisch",type:"text"},
{q:"Was bedeutet 'Takk'?",correct:"Danke",options:["Danke","Hallo","Bitte","Nein"]},
{q:"Ãœbersetze: 'God morgen'",correct:"Guten Morgen",type:"text"},
{q:"Was bedeutet 'Ha det'?",correct:"TschÃ¼ss",options:["Bitte","TschÃ¼ss","Danke","Ja"]}
],
spa:[
{q:"Was bedeutet 'Gracias'?",correct:"Danke",options:["Hallo","Danke","Bitte","Nein"]},
{q:"Ãœbersetze: 'Buenos dÃ­as'",correct:"Guten Morgen",type:"text"},
{q:"Was bedeutet 'Hola'?",correct:"Hallo",options:["Hallo","Danke","Bitte","TschÃ¼ss"]},
{q:"Ãœbersetze: 'Estoy aprendiendo espaÃ±ol'",correct:"Ich lerne Spanisch",type:"text"},
{q:"Was bedeutet 'AdiÃ³s'?",correct:"TschÃ¼ss",options:["Hallo","Bitte","TschÃ¼ss","Nein"]}
],
eng:[
{q:"Was bedeutet 'Apple'?",correct:"Apfel",options:["Apfel","Birne","Banane","Traube"]},
{q:"Ãœbersetze: 'Good morning'",correct:"Guten Morgen",type:"text"},
{q:"Was bedeutet 'Thank you'?",correct:"Danke",options:["Bitte","Danke","Hallo","Nein"]},
{q:"Ãœbersetze: 'I learn English'",correct:"Ich lerne Englisch",type:"text"},
{q:"Was bedeutet 'Goodbye'?",correct:"TschÃ¼ss",options:["Bitte","Danke","TschÃ¼ss","Hallo"]}
]
};

let lessonQueue=[];
let wrongQueue=[];
let currentQuestion=null;
let questionCount=0;

function startLesson(lang){
lessonQueue=[...questions[lang]];
wrongQueue=[];
questionCount=0;
document.getElementById("menu").style.display="none";
document.getElementById("lesson").style.display="block";
nextQuestion();
}

function nextQuestion(){
if(questionCount>=5){
if(wrongQueue.length>0){
lessonQueue.push(...wrongQueue);
wrongQueue=[];
}
else{
document.getElementById("lesson").innerHTML=
`<div class="card"><h2>ğŸ‰ Lektion abgeschlossen!</h2>
<button onclick="goHome()">ZurÃ¼ck zum MenÃ¼</button></div>`;
return;
}
}

currentQuestion=lessonQueue.shift();
questionCount++;

renderQuestion(currentQuestion);
}

function renderQuestion(q){
let repeatMark = q.wasWrong ? "<div class='repeat'>ğŸ” Wiederholung</div>" : "";
if(q.type==="text"){
document.getElementById("lesson").innerHTML=
`<div class="card">
${repeatMark}
<h3>${q.q}</h3>
<input id="textAnswer" placeholder="Deine Antwort...">
<br>
<button onclick="checkText()">PrÃ¼fen</button>
</div>`;
}else{
let shuffled=[...q.options].sort(()=>0.5-Math.random());
let buttons="";
shuffled.forEach(opt=>{
buttons+=`<button onclick="checkAnswer('${opt}')">${opt}</button>`;
});
document.getElementById("lesson").innerHTML=
`<div class="card">
${repeatMark}
<h3>${q.q}</h3>
${buttons}
</div>`;
}
}

function similarity(a,b){
a=a.toLowerCase();
b=b.toLowerCase();
let diff=0;
for(let i=0;i<Math.max(a.length,b.length);i++){
if(a[i]!==b[i]) diff++;
}
return diff<=2;
}

function checkText(){
let input=document.getElementById("textAnswer").value;
if(similarity(input,currentQuestion.correct)){
gainXP(10);
nextQuestion();
}else{
currentQuestion.wasWrong=true;
wrongQueue.push(currentQuestion);
nextQuestion();
}
}

function checkAnswer(answer){
if(answer===currentQuestion.correct){
gainXP(5);
nextQuestion();
}else{
currentQuestion.wasWrong=true;
wrongQueue.push(currentQuestion);
nextQuestion();
}
}

function gainXP(amount){
xp+=amount;
localStorage.setItem("xp",xp);
let newLevel=Math.floor(xp/50)+1;
if(newLevel>level){
level=newLevel;
localStorage.setItem("level",level);
alert("ğŸ‰ Level Up!");
}
updateUI();
}

function updateUI(){
document.getElementById("xp").innerText=xp;
document.getElementById("level").innerText=level;
document.getElementById("progress").style.width=(xp%50)*2+"%";
}

function goHome(){
document.getElementById("lesson").style.display="none";
document.getElementById("menu").style.display="block";
}

updateUI();
</script>

</body>
</html>
