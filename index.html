<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Trilingua</title>

<link rel="apple-touch-icon" href="logo.png">
<link rel="icon" href="logo.png">

<style>
body {
  margin: 0;
  font-family: -apple-system, BlinkMacSystemFont, sans-serif;
  background: #f2f7fb;
  text-align: center;
}

h1 {
  margin-top: 30px;
}

.level-container {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 15px;
  padding: 30px;
  max-width: 500px;
  margin: auto;
}

.level {
  padding: 20px;
  border-radius: 15px;
  background: #4da6ff;
  color: white;
  font-weight: bold;
  cursor: pointer;
}

.level.locked {
  background: #777;
  cursor: not-allowed;
}

.card {
  background: white;
  padding: 20px;
  margin: 30px;
  border-radius: 20px;
}

button {
  margin: 10px;
  padding: 10px 15px;
  border-radius: 10px;
  border: none;
  background: #4da6ff;
  color: white;
  cursor: pointer;
}
</style>
</head>

<body>

<h1>Trilingua</h1>

<div id="menu" class="level-container"></div>
<div id="game"></div>

<script>

let unlockedLevel = parseInt(localStorage.getItem("unlockedLevel")) || 1;
let currentLevel = 1;
let questions = [];
let queue = [];
let wrongQueue = [];
let questionCount = 0;

const allQuestions = {
  1: [
    {q:"Hei means?", a:"Hello", options:["Hello","Bye","Thanks"]},
    {q:"Takk means?", a:"Thanks", options:["Hello","Thanks","Milk"]},
    {q:"Hva means?", a:"What", options:["Who","What","Where"]},
    {q:"BrÃ¸d means?", a:"Bread", options:["Bread","Fish","Water"]},
    {q:"Mor means?", a:"Mother", options:["Father","Mother","Friend"]}
  ],
  2: [
    {q:"Rojo means?", a:"Red", options:["Blue","Red","Green"]},
    {q:"Azul means?", a:"Blue", options:["Red","Blue","Yellow"]},
    {q:"Camisa means?", a:"Shirt", options:["Shirt","Shoes","Hat"]},
    {q:"Zapatos means?", a:"Shoes", options:["Shoes","Jacket","Hat"]},
    {q:"Negro means?", a:"Black", options:["White","Black","Pink"]}
  ],
  3: [
    {q:"Apple means?", a:"Apfel", options:["Apfel","Birne","Banane"]},
    {q:"Dog means?", a:"Hund", options:["Katze","Hund","Vogel"]},
    {q:"House means?", a:"Haus", options:["Haus","Auto","Schule"]},
    {q:"Water means?", a:"Wasser", options:["Milch","Saft","Wasser"]},
    {q:"Friend means?", a:"Freund", options:["Feind","Freund","Lehrer"]}
  ]
};

// Fill up to level 10 automatically
for(let i=4;i<=10;i++){
  allQuestions[i]=allQuestions[3];
}

function renderMenu(){
  const menu = document.getElementById("menu");
  menu.innerHTML = "";
  for(let i=1;i<=10;i++){
    const div = document.createElement("div");
    div.className="level";
    div.innerText="Level "+i;

    if(i>unlockedLevel){
      div.classList.add("locked");
    } else {
      div.onclick=()=>startLevel(i);
    }

    menu.appendChild(div);
  }
}

function startLevel(level){
  currentLevel = level;
  questions = [...allQuestions[level]];
  queue = [...questions];
  wrongQueue = [];
  questionCount = 0;
  document.getElementById("menu").style.display="none";
  nextQuestion();
}

function nextQuestion(){

  if(questionCount>=5){
    if(wrongQueue.length>0){
      queue = [...wrongQueue];
      wrongQueue=[];
      questionCount=0;
    } else {
      finishLevel();
      return;
    }
  }

  const question = queue.shift();
  questionCount++;
  renderQuestion(question);
}

function renderQuestion(question){
  const game = document.getElementById("game");

  let html = `<div class="card"><h2>${question.q}</h2>`;

  question.options.forEach(opt=>{
    html += `<button onclick="answer('${opt}','${question.a}')">${opt}</button>`;
  });

  html += `</div>`;
  game.innerHTML = html;
}

function answer(choice, correct){
  if(choice!==correct){
    wrongQueue.push({q:document.querySelector("h2").innerText, a:correct, options:[correct]});
  }
  setTimeout(nextQuestion, 400);
}

function finishLevel(){
  document.getElementById("game").innerHTML=
  `<div class="card">
    <h2>Level Completed ðŸŽ‰</h2>
    <button onclick="goHome()">Back to Menu</button>
   </div>`;

  if(currentLevel===unlockedLevel && unlockedLevel<10){
    unlockedLevel++;
    localStorage.setItem("unlockedLevel", unlockedLevel);
  }
}

function goHome(){
  document.getElementById("menu").style.display="grid";
  document.getElementById("game").innerHTML="";
  renderMenu();
}

renderMenu();

</script>
</body>
</html>
