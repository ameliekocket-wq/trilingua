<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Trilingua</title>

<style>
body{
    margin:0;
    font-family:-apple-system, BlinkMacSystemFont, sans-serif;
    background:#f2f7fb;
    text-align:center;
    color:#333;
}

header{
    background:#cfe9f7;
    padding:25px;
    border-bottom-left-radius:25px;
    border-bottom-right-radius:25px;
}

h1{margin:0;}

button{
    padding:12px 18px;
    margin:8px;
    border:none;
    border-radius:15px;
    font-size:16px;
    cursor:pointer;
    transition:0.2s;
}

.langBtn{width:200px;}

.map{
    display:flex;
    flex-direction:column;
    align-items:center;
    margin-top:20px;
}

.level{
    width:120px;
    height:120px;
    border-radius:50%;
    display:flex;
    align-items:center;
    justify-content:center;
    font-weight:bold;
    font-size:18px;
    margin:20px;
    cursor:pointer;
    transition:0.3s;
}

.locked{
    background:#ddd;
    color:#888;
}

.unlocked{
    background:#6ec5ff;
    color:white;
}

.completed{
    background:#4caf50;
    color:white;
}

.card{
    background:white;
    padding:20px;
    margin:20px auto;
    border-radius:20px;
    width:90%;
    max-width:400px;
    box-shadow:0 5px 15px rgba(0,0,0,0.1);
}

input{
    padding:10px;
    border-radius:10px;
    border:1px solid #ccc;
    width:80%;
}
</style>
</head>

<body>

<header>
<h1>Trilingua</h1>
<p>XP: <span id="xp">0</span></p>
</header>

<div id="menu">
<button class="langBtn" onclick="openMap('nor')">üá≥üá¥ Norwegisch</button>
<button class="langBtn" onclick="openMap('spa')">üá™üá∏ Spanisch</button>
<button class="langBtn" onclick="openMap('eng')">üá¨üáß Englisch</button>
</div>

<div id="map" style="display:none;"></div>

<div id="lesson" style="display:none;"></div>

<script>

let XP = parseInt(localStorage.getItem("xp")) || 0;
document.getElementById("xp").innerText = XP;

let currentLang = "";
let currentLevel = 1;
let queue = [];
let wrongQueue = [];
let index = 0;

const levelUnlockXP = [0, 20, 50, 90];

const data = {
nor: [
[
{q:"Was hei√üt 'takk'?",a:"danke",o:["danke","bitte","hallo"]},
{q:"Was hei√üt 'br√∏d'?",a:"brot",o:["brot","milch","wein"]},
{q:"√úbersetze: jeg",a:"ich",type:"text"},
{q:"Was hei√üt 'mor'?",a:"mutter",o:["vater","mutter","schwester"]},
{q:"Was hei√üt 'ost'?",a:"k√§se",o:["k√§se","brot","pizza"]}
],
[
{q:"Was hei√üt 'venn'?",a:"freund",o:["freund","opa","oma"]},
{q:"√úbersetze: far",a:"vater",type:"text"},
{q:"Was hei√üt 'vann'?",a:"wasser",o:["wasser","wein","bier"]},
{q:"Was hei√üt 'hvor'?",a:"wo",o:["wo","wann","warum"]},
{q:"Was hei√üt 'dyr'?",a:"teuer",o:["billig","teuer","neu"]}
]
],
spa: [
[
{q:"Was hei√üt 'rojo'?",a:"rot",o:["rot","blau","gr√ºn"]},
{q:"√úbersetze: casa",a:"haus",type:"text"},
{q:"Was hei√üt 'perro'?",a:"hund",o:["katze","hund","vogel"]},
{q:"Was hei√üt 'escuela'?",a:"schule",o:["schule","arbeit","markt"]},
{q:"Was hei√üt 'negro'?",a:"schwarz",o:["wei√ü","schwarz","gelb"]}
],
[
{q:"√úbersetze: madre",a:"mutter",type:"text"},
{q:"Was hei√üt 'azul'?",a:"blau",o:["blau","rot","pink"]},
{q:"Was hei√üt 'pantalones'?",a:"hose",o:["jacke","hose","schuhe"]},
{q:"Was hei√üt 'zapatos'?",a:"schuhe",o:["schuhe","socken","hut"]},
{q:"Was hei√üt 'hermano'?",a:"bruder",o:["bruder","schwester","freund"]}
]
],
eng: [
[
{q:"Was hei√üt 'dog'?",a:"hund",o:["hund","katze","maus"]},
{q:"√úbersetze: house",a:"haus",type:"text"},
{q:"Was hei√üt 'blue'?",a:"blau",o:["blau","rot","gelb"]},
{q:"Was hei√üt 'school'?",a:"schule",o:["schule","arbeit","markt"]},
{q:"Was hei√üt 'mother'?",a:"mutter",o:["mutter","tante","oma"]}
],
[
{q:"√úbersetze: father",a:"vater",type:"text"},
{q:"Was hei√üt 'green'?",a:"gr√ºn",o:["gr√ºn","orange","pink"]},
{q:"Was hei√üt 'shirt'?",a:"hemd",o:["hose","hemd","jacke"]},
{q:"Was hei√üt 'shoes'?",a:"schuhe",o:["schuhe","hut","socken"]},
{q:"Was hei√üt 'friend'?",a:"freund",o:["opa","freund","arzt"]}
]
]
};

function openMap(lang){
currentLang = lang;
document.getElementById("menu").style.display="none";
let mapDiv = document.getElementById("map");
mapDiv.style.display="block";
mapDiv.innerHTML="<h2>Level ausw√§hlen</h2><div class='map'></div><button onclick='goHome()'>Zur√ºck</button>";
let container = mapDiv.querySelector(".map");

for(let i=0;i<data[lang].length;i++){
let levelDiv=document.createElement("div");
levelDiv.classList.add("level");

if(XP>=levelUnlockXP[i]){
levelDiv.classList.add("unlocked");
levelDiv.innerText="Level "+(i+1);
levelDiv.onclick=()=>startLesson(i);
}else{
levelDiv.classList.add("locked");
levelDiv.innerText="üîí";
}

container.appendChild(levelDiv);
}
}

function startLesson(level){
currentLevel=level;
queue=[...data[currentLang][level]];
wrongQueue=[];
index=0;
document.getElementById("map").style.display="none";
document.getElementById("lesson").style.display="block";
nextQuestion();
}

function nextQuestion(){
if(index>=queue.length){
if(wrongQueue.length>0){
queue=[...wrongQueue];
wrongQueue=[];
index=0;
}else{
XP+=10;
localStorage.setItem("xp",XP);
document.getElementById("xp").innerText=XP;
document.getElementById("lesson").innerHTML="<div class='card'><h2>üéâ Level geschafft!</h2><button onclick='goHome()'>Zur√ºck zum Men√º</button></div>";
return;
}
}

render(queue[index]);
index++;
}

function render(q){
let lesson=document.getElementById("lesson");
let html="<div class='card'><h3>"+q.q+"</h3>";

if(q.type==="text"){
html+="<input id='answer'><br><button onclick='checkText(\""+q.a+"\")'>OK</button>";
}else{
q.o.forEach(opt=>{
html+="<button onclick='checkOption(\""+opt+"\",\""+q.a+"\")'>"+opt+"</button><br>";
});
}

html+="<br><button onclick='goHome()'>Zur√ºck</button></div>";
lesson.innerHTML=html;
}

function checkOption(opt,correct){
if(opt.toLowerCase()!==correct.toLowerCase()){
wrongQueue.push(queue[index-1]);
}
setTimeout(nextQuestion,500);
}

function checkText(correct){
let val=document.getElementById("answer").value.toLowerCase().trim();
if(val!==correct.toLowerCase()){
wrongQueue.push(queue[index-1]);
}
setTimeout(nextQuestion,500);
}

function goHome(){
document.getElementById("lesson").style.display="none";
document.getElementById("map").style.display="none";
document.getElementById("menu").style.display="block";
}
</script>

</body>
</html>
