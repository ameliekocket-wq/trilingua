<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Trilingua</title>

<style>
body{
    margin:0;
    font-family:-apple-system,BlinkMacSystemFont,sans-serif;
    background:#f4f6fb;
    text-align:center;
}

header{
    background:#dfe8f3;
    padding:20px;
    border-bottom-left-radius:30px;
    border-bottom-right-radius:30px;
}

header img{
    width:120px;
    margin-bottom:10px;
}

.level{
    margin:10px auto;
    padding:15px;
    width:220px;
    border-radius:15px;
    background:#cfe2ff;
    cursor:pointer;
    font-weight:bold;
}

.locked{
    background:#999;
    color:white;
    cursor:not-allowed;
}

.card{
    background:white;
    padding:20px;
    margin:20px;
    border-radius:20px;
}

button{
    padding:10px 20px;
    margin:5px;
    border:none;
    border-radius:10px;
    background:#4a90e2;
    color:white;
    font-weight:bold;
}

.back{
    background:#888;
}

input{
    padding:8px;
    border-radius:8px;
    border:1px solid #ccc;
}
</style>
</head>

<body>

<header>
    <img src="logo.png">
    <h2>Level ausw√§hlen</h2>
</header>

<div id="menu"></div>
<div id="lesson" style="display:none;"></div>

<script>

let unlocked = parseInt(localStorage.getItem("unlocked")) || 1;
let currentLevel = 1;
let queue = [];
let wrongQueue = [];
let questionCount = 0;

const questions = {
1:[
{q:"Was hei√üt 'Hei'?",a:"Hallo",options:["Hallo","Danke","Bitte","Tsch√ºss"]},
{q:"Was hei√üt 'Takk'?",a:"Danke",options:["Hallo","Danke","Bitte","Nein"]},
{q:"Was hei√üt 'Br√∏d'?",a:"Brot",options:["Brot","Milch","Fisch","K√§se"]},
{q:"Was hei√üt 'Mor'?",a:"Mutter",options:["Vater","Mutter","Bruder","Schwester"]},
{q:"Was hei√üt 'Vann'?",a:"Wasser",options:["Milch","Wasser","Saft","Tee"]}
],

2:[
{q:"√úbersetze: Buenos d√≠as",a:"Guten Morgen",type:"text"},
{q:"Was hei√üt 'Gracias'?",a:"Danke",options:["Bitte","Danke","Hallo","Nein"]},
{q:"√úbersetze: Yo habl√©",a:"Ich sprach",type:"text"},
{q:"Was hei√üt 'Rojo'?",a:"Rot",options:["Rot","Blau","Gr√ºn","Gelb"]},
{q:"Was hei√üt 'Zapatos'?",a:"Schuhe",options:["Hemd","Schuhe","Hose","Jacke"]}
],

3:[
{q:"Was hei√üt 'Apple'?",a:"Apfel",options:["Apfel","Birne","Banane","Traube"]},
{q:"√úbersetze: I went",a:"Ich ging",type:"text"},
{q:"Was hei√üt 'Teacher'?",a:"Lehrer",options:["Arzt","Lehrer","Sch√ºler","Polizist"]},
{q:"Was hei√üt 'Blue'?",a:"Blau",options:["Blau","Rot","Schwarz","Wei√ü"]},
{q:"Was hei√üt 'Shirt'?",a:"Hemd",options:["Hemd","Hose","Kleid","Jacke"]}
]
};

// bis Level 10 automatisch kopieren
for(let i=4;i<=10;i++){
    questions[i]=questions[1];
}

function renderMenu(){
    document.getElementById("lesson").style.display="none";
    document.getElementById("menu").style.display="block";
    let html="";
    for(let i=1;i<=10;i++){
        if(i<=unlocked){
            html+=`<div class="level" onclick="startLevel(${i})">Level ${i}</div>`;
        }else{
            html+=`<div class="level locked">Level ${i}</div>`;
        }
    }
    document.getElementById("menu").innerHTML=html;
}

function startLevel(lvl){
    currentLevel=lvl;
    queue=[...questions[lvl]];
    wrongQueue=[];
    questionCount=0;
    document.getElementById("menu").style.display="none";
    document.getElementById("lesson").style.display="block";
    nextQuestion();
}

function nextQuestion(){
    if(questionCount>=5){
        if(wrongQueue.length>0){
            queue=[...wrongQueue];
            wrongQueue=[];
            questionCount=0;
        }else{
            finishLevel();
            return;
        }
    }

    let q=queue.shift();
    questionCount++;

    let html=`<div class="card"><h3>${q.q}</h3>`;

    if(q.type==="text"){
        html+=`<input id="answer"><br><br>
        <button onclick="checkText('${q.a}')">OK</button>`;
    }else{
        q.options.forEach(opt=>{
            html+=`<button onclick="checkOption('${opt}','${q.a}')">${opt}</button><br>`;
        });
    }

    html+=`<br><button class="back" onclick="renderMenu()">Zur√ºck</button></div>`;

    document.getElementById("lesson").innerHTML=html;
}

function checkOption(choice,correct){
    if(choice!==correct){
        wrongQueue.push({q:document.querySelector("h3").innerText,a:correct,options:[correct]});
    }
    nextQuestion();
}

function checkText(correct){
    let input=document.getElementById("answer").value.trim();
    if(input.toLowerCase()!==correct.toLowerCase()){
        wrongQueue.push({q:document.querySelector("h3").innerText,a:correct,type:"text"});
    }
    nextQuestion();
}

function finishLevel(){
    if(currentLevel===unlocked && unlocked<10){
        unlocked++;
        localStorage.setItem("unlocked",unlocked);
    }

    document.getElementById("lesson").innerHTML=
    `<div class="card">
    <h2>üéâ Level geschafft!</h2>
    <button onclick="renderMenu()">Zur√ºck zum Men√º</button>
    </div>`;
}

renderMenu();

</script>
</body>
</html>
